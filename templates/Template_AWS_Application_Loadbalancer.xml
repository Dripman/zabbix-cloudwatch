<?xml version="1.0" ?>
<zabbix_export>
   <version>4.4</version>
   <date>2020-01-28T11:58:29Z</date>
   <groups>
      <group>
         <name>Templates</name>
      </group>
   </groups>
   <templates>
      <template>
         <template>Template AWS Application Loadbalancer</template>
         <name>Template AWS Application Loadbalancer</name>
         <groups>
            <group>
               <name>Templates</name>
            </group>
         </groups>
         <applications>
            <application>
               <name>AWS - Application ELB</name>
            </application>
         </applications>
         <items>
            <item>
               <name>ALB Active Connection Count</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;ActiveConnectionCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The total number of concurrent TCP connections active from clients to the load balancer and from the load balancer to targets.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>ALB Client TLS Negotiation Errors</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;ClientTLSNegotiationErrorCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of TLS connections initiated by the client that did not establish a session with the load balancer. Possible causes include a mismatch of ciphers or protocols.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Healthy Hosts</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HealthyHostCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of targets that are considered healthy.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
               <triggers>
                  <trigger>
                     <expression>{last()}&lt;1</expression>
                     <name>No healthy hosts available on {HOSTNAME} for {$AWS_ALB_TARGET_GROUP}</name>
                     <priority>HIGH</priority>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>ALB Sum ELB HTTP 4XXs</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_ELB_4XX&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of HTTP 4XX client error codes that originate from the load balancer. Client errors are generated when requests are malformed or incomplete. These requests have not been received by the target. This count does not include any response codes generated by the targets.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>ALB Sum ELB HTTP 5XXs</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_ELB_5XX&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of HTTP 5XX server error codes that originate from the load balancer. This count does not include any response codes generated by the targets.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Sum HTTP 2XXs</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_Target_2XX_Count&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of HTTP response codes generated by the targets. This does not include any response codes generated by the load balancer.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Sum HTTP 3XXs</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_Target_3XX_Count&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of HTTP response codes generated by the targets. This does not include any response codes generated by the load balancer.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Sum HTTP 4XXs</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_Target_4XX_Count&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of HTTP response codes generated by the targets. This does not include any response codes generated by the load balancer.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Sum HTTP 5XXs</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_Target_5XX_Count&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of HTTP response codes generated by the targets. This does not include any response codes generated by the load balancer.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
               <triggers>
                  <trigger>
                     <expression>{avg(5)}&gt;200</expression>
                     <name>More than 200 5xx errors on {$AWS_ALB_TARGET_GROUP}</name>
                     <priority>WARNING</priority>
                  </trigger>
                  <trigger>
                     <expression>{avg(5)}&gt;200</expression>
                     <name>More than 300 5xx errors on {$AWS_ALB_TARGET_GROUP}</name>
                     <priority>AVERAGE</priority>
                     <dependencies>
                        <dependency>
                           <name>More than 200 5xx errors on {$AWS_ALB_TARGET_GROUP}</name>
                           <expression>{Template AWS Application Loadbalancer:app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_Target_5XX_Count&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;].avg(5)}&gt;200</expression>
                        </dependency>
                     </dependencies>
                  </trigger>
                  <trigger>
                     <expression>{avg(5)}&gt;200</expression>
                     <name>More than 400 5xx errors on {$AWS_ALB_TARGET_GROUP}</name>
                     <priority>HIGH</priority>
                     <dependencies>
                        <dependency>
                           <name>More than 300 5xx errors on {$AWS_ALB_TARGET_GROUP}</name>
                           <expression>{Template AWS Application Loadbalancer:app_elb_stats.py[&quot;--metric&quot;,&quot;HTTPCode_Target_5XX_Count&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;].avg(5)}&gt;200</expression>
                        </dependency>
                     </dependencies>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>ALB New Connection Count</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;NewConnectionCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The total number of new TCP connections established from clients to the load balancer and from the load balancer to targets.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>ALB Processed Bytes</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;ProcessedBytes&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <value_type>FLOAT</value_type>
               <units>Bytes</units>
               <description>The total number of bytes processed by the load balancer over IPv4 and IPv6.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>ALB Rejected Connection Count</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;RejectedConnectionCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of connections that were rejected because the load balancer had reached its maximum number of connections.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>ALB Sum Requests</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;RequestCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of requests received by the load balancer. This includes requests over IPv4 and IPv6.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Backend Connection Errors</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;TargetConnectionErrorCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of connections that were not successfully established between the load balancer and target.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>ALB Average Latency</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;TargetResponseTime&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <value_type>FLOAT</value_type>
               <units>seconds</units>
               <description>The time elapsed, in seconds, after the request leaves the load balancer until a response from the target is received. This is equivalent to the target_processing_time field in the access logs.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Average Latency</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;TargetResponseTime&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <value_type>FLOAT</value_type>
               <units>seconds</units>
               <description>The time elapsed, in seconds, after the request leaves the load balancer until a response from the target is received. This is equivalent to the target_processing_time field in the access logs.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup TLS Negotiation Errors</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;TargetTLSNegotiationErrorCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <description>The number of TLS connections initiated by the load balancer that did not establish a session with the target. Possible causes include a mismatch of ciphers or protocols.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
            <item>
               <name>TargetGroup Unhealthy Hosts</name>
               <type>EXTERNAL</type>
               <key>app_elb_stats.py[&quot;--metric&quot;,&quot;UnHealthyHostCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               <delay>5m</delay>
               <history>2w</history>
               <trends>1w</trends>
               <status>DISABLED</status>
               <description>The number of targets that are considered unhealthy.</description>
               <applications>
                  <application>
                     <name>AWS - Application ELB</name>
                  </application>
               </applications>
               <request_method>POST</request_method>
            </item>
         </items>
         <macros>
            <macro>
               <macro>{$AWS_ACCESS_KEY}</macro>
            </macro>
            <macro>
               <macro>{$AWS_ALB_AVAILABILITY_ZONE}</macro>
            </macro>
            <macro>
               <macro>{$AWS_ALB_LOADBALANCER_NAME}</macro>
            </macro>
            <macro>
               <macro>{$AWS_ALB_TARGET_GROUP}</macro>
            </macro>
            <macro>
               <macro>{$AWS_REGION}</macro>
               <value>eu-west-1</value>
            </macro>
            <macro>
               <macro>{$AWS_SECRET_KEY}</macro>
            </macro>
         </macros>
      </template>
   </templates>
   <graphs>
      <graph>
         <name>Hosts count</name>
         <graph_items>
            <graph_item>
               <color>00C800</color>
               <item>
                  <host>Template AWS Application Loadbalancer</host>
                  <key>app_elb_stats.py[&quot;--metric&quot;,&quot;HealthyHostCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--target-group&quot;,&quot;{$AWS_ALB_TARGET_GROUP}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
      <graph>
         <name>Requests</name>
         <graph_items>
            <graph_item>
               <color>00C800</color>
               <item>
                  <host>Template AWS Application Loadbalancer</host>
                  <key>app_elb_stats.py[&quot;--metric&quot;,&quot;RequestCount&quot;,&quot;--instance-id&quot;,&quot;{$AWS_ALB_LOADBALANCER_NAME}&quot;,&quot;--access-key&quot;,&quot;{$AWS_ACCESS_KEY}&quot;,&quot;--secret-key&quot;,&quot;{$AWS_SECRET_KEY}&quot;,&quot;--region&quot;,&quot;{$AWS_REGION}&quot;]</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
   </graphs>
</zabbix_export>
